#!/bin/bash

#set -e

BINARY=$1
FILE=voxedit/chr_knight.qb

if [ -z "$BINARY" ]; then
  BINARY=@CMAKE_BINARY_DIR@/@PROJECT_NAME@/@CMAKE_PROJECT_NAME@-@PROJECT_NAME@
fi

$BINARY -s 128 @DATA_DIR@/$FILE @CMAKE_BINARY_DIR@/${FILE%.*}.png
md5=`md5sum @CMAKE_BINARY_DIR@/${FILE%.*}.png`
if [ "$md5" != "da164ba47de2db7a0ea1d4f6c4312b25" ]; then
  echo "Md5 sums don't match"
  xdg-open @CMAKE_BINARY_DIR@/${FILE%.*}.png
  exit 1;
fi
echo "Md5 of generated screenshot matches"
